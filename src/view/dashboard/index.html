{% extends "layout.html" %}

{% block head %}
Hi, {{member.name}}
{% endblock %}

{% block content %}

<div class="row">
  <div class="span12">
    <div class="tag-list" data-list_url="/tag">
    </div>
  </div>
</div>

<div class="row">
  <div class="span12">
    <h2>Topics</h2>
  </div>
</div>

<div class="row">
  <div class="span5">
    <form method="post" action="/topic/create" class="form-inline new_topic">
      <div class="input-append">
        <input type="text" placeholder="New topic" name="topic_text" class="topic_text">
        <button type="submit" class="btn">Add</button>
      </div>
    </form>
    <div class="topics" data-list_url="/topic"></div>
  </div>

  <div class="span4 topic-messages"></div>
</div>

<script type="text/html" id='topic'>
  <div class="topic">
    <h4>
      <a href="#messages"><%= topic_text %></a>
      <small><%= member_name %></small>
    </h4>
  </div>
</script>

<script type="text/html" id='topic-content'>
  <div class="topic">
    <h4>
      <%= topic_text %>
      <small><%= member_name %></small>
    </h4>

    <div class="message_box" data-poll_url="/chatmessage/poll/<%= topic_id %>"
        data-list_url="/chatmessage/index/<%= topic_id %>">
      <ul class="messages"></ul>
      <form method="post" action="/chatmessage/create/<%= topic_id %>" class="form-inline new_message">
        <div class="input-append">
          <input type="text" placeholder="New message" name="text" class="message_text">
          <button type="submit" class="btn">Reply</button>
        </div>
      </form>
    </div>
  </div>
</script>

<script type="text/html" id='message'>
  <li>
    <%= text %>
    <small><%= member_name %></small>
  </li>
</script>

<script type="text/html" id='tag'>
  <a href="/topic/index/tag/<%= id %>" class="label label-info">
    #<%= text %>
  </span>
</script>

{% endblock %}

{% block scripts %}
  <script src="/static/js/app.js"></script>
  <script>
    $(function () {
      new Tags()
      new Topics()
      new Messages()
    })
  </script>
{% endblock %}
